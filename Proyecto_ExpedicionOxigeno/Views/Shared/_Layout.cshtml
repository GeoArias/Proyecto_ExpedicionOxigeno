@using Microsoft.AspNet.Identity
@using Microsoft.AspNet.Identity.Owin
@using Microsoft.Owin.Security
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@ViewBag.Title - ExpediCheck</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Francy&display=swap" rel="stylesheet">



    <style>

      

        .btn-Primary-ExpOxi {
            background-color: rgb(250, 143, 35) !important;
            color: white !important;
            font-weight: 600;
            border-color: rgb(250, 143, 35) !important;
            transition: all 0.3s ease;
        }

            .btn-Primary-ExpOxi:hover {
                background-color: rgb(230, 123, 15) !important;
                border-color: rgb(230, 123, 15) !important;
                color: white !important;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            }

        :root {
            --cyan: #00ffff;
            --azul-fondo: #100b2c;
            --blanco: #ffffff;
        }

        html {
            scroll-behavior: smooth;
        }

        body, h1, h2, h3, h4, h5, h6, .navbar-brand {
            font-family: 'Francy', sans-serif;
            color: #111;
        }

            body::before {
                content: "";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url('/Content/Images/BG.jpeg');
                background-size: cover;
                background-repeat: no-repeat;
                background-position: center;
                opacity: 0.17;
                z-index: -10;
            }

        h1, .navbar-brand {
            font-size: 32px;
            font-weight: 400;
            color: #28a745;
        }

        h2 {
            font-size: 24px;
            font-weight: 600;
            color: var(--azul-fondo);
        }

        .navbar {
            position: fixed !important; /* Always fixed at the top */
            top: 0;
            left: 0;
            width: 100%; /* Full width */
            background-color: var(--azul-fondo);
            padding: 1rem 0;
            z-index: 1030; /* On top of other elements */
            transition: none; /* No transition needed */
        }

            .navbar.hidden {
                top: -100px;
            }

            .navbar.transparent {
                background-color: transparent !important;
            }

        .navbar-brand img {
            height: 48px;
            margin-right: 10px;
        }

        .nav-link {
            color: var(--blanco) !important;
            font-weight: 500;
            padding: 8px 16px;
            transition: all 0.3s ease-in-out;
            border-radius: 8px;
        }

            .nav-link:hover {
                color: #28a745 !important;
            }

        .nav-login,
        .nav-register {
            background-color: rgb(250, 143, 35) !important;
            color: white !important;
            font-weight: 600;
            border-radius: 8px;
            margin-left: 8px;
            padding: 8px 16px;
            transition: all 0.3s ease;
            text-decoration: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            border: none;
            display: inline-block;
        }

            .nav-login:hover,
            .nav-register:hover {
                background-color: rgb(230, 123, 15) !important; /* Un poco más oscuro para el hover */
                color: white !important;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            }

        .hero-banner {
            position: absolute;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            margin: 0;
            padding: 0;
            overflow: hidden;
            z-index: 0;
        }

        .body-content, main.container {
            position: relative;
            z-index: 1;
            padding-top: 90px; /* Ajusta este valor a la altura real de tu navbar */
        }

        .hero-banner video {
            position: absolute;
            top: -90px; /* igual a la altura de tu navbar */
            left: 0;
            min-width: 100vw;
            min-height: calc(100vh + 90px); /* cubre el área extra */
            object-fit: cover;
            z-index: -1;
        }

        .hero-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            z-index: 2;
        }

        .container.hero-container {
            padding-left: 0 !important;
            padding-right: 0 !important;
        }

        .hero-spacer {
            height: 100vh;
            width: 100vw;
        }

        section {
            padding: 80px 0;
            border-bottom: 1px solid #111;
        }

        .navbar-nav .dropdown:hover .dropdown-menu {
            display: block;
            margin-top: 0;
        }

        /* ===== ESTILOS DEL FOOTER ===== */
        footer {
            background-color: var(--azul-fondo);
            color: var(--blanco);
            padding: 50px 20px 20px;
            font-family: 'Francy', sans-serif;
            margin-top: 50px;
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            border-radius: 12px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }

            footer h3 {
                font-size: 20px;
                font-weight: 600;
                color: #28a745;
                margin-bottom: 20px;
                font-family: 'Francy', sans-serif;
                border-bottom: 2px solid #28a745;
                padding-bottom: 8px;
                display: inline-block;
            }

            footer h5 {
                font-family: 'Francy', sans-serif;
                color: var(--blanco) !important;
                margin-top: 20px;
                margin-bottom: 15px;
            }

            footer p {
                font-family: 'Francy', sans-serif;
                color: #ccc;
                line-height: 1.6;
                margin-bottom: 15px;
                font-size: 16px; /* ⬅ Mejora de legibilidad */
            }

        .column.contact-about img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .column.contact-about ul {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
        }

            .column.contact-about ul li {
                margin-bottom: 15px;
                font-family: 'Francy', sans-serif;
            }

                .column.contact-about ul li p {
                    margin: 0;
                    color: #ccc;
                    font-size: 16px;
                }

                .column.contact-about ul li a {
                    color: #28a745;
                    text-decoration: none;
                    transition: color 0.3s ease;
                }

                    .column.contact-about ul li a:hover {
                        color: var(--blanco);
                    }

        .social-icons {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

            .social-icons a {
                display: flex; /* ← para centrar imagen dentro */
                justify-content: center;
                align-items: center;
                transition: transform 0.3s ease;
                border-radius: 50%;
                width: 60px; /* ⬅ Hacerlo perfectamente redondo */
                height: 60px;
                padding: 0;
                background-color: rgba(255, 255, 255, 0.1);
                overflow: hidden;
            }

                .social-icons a:hover {
                    transform: translateY(-3px);
                    background-color: #28a745;
                }

            .social-icons img {
                width: 28px;
                height: 28px;
                object-fit: contain;
                border-radius: 50%;
            }

        .column.address {
            text-align: center;
            background: rgba(40, 167, 69, 0.1);
            padding: 30px;
            border-radius: 12px;
            border: 2px solid rgba(40, 167, 69, 0.3);
        }

            .column.address h3 {
                font-size: 22px;
                margin-bottom: 15px;
                color: var(--blanco);
                border-bottom: 2px solid #28a745;
            }

            .column.address p {
                font-size: 20px;
                font-weight: 600;
                color: var(--blanco);
                margin-bottom: 20px;
                font-family: 'Francy', sans-serif;
            }

            .column.address iframe {
                width: 100%;
                height: 200px;
                border: 2px solid #28a745;
                border-radius: 8px;
                margin-top: 15px;
            }

        footer center {
            grid-column: 1 / -1;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 25px;
            margin-top: 20px;
        }

            footer center p {
                color: #ccc;
                font-size: 14px;
                font-family: 'Francy', sans-serif;
                margin: 0;
            }

        /* Responsive para móviles */
        @@media (max-width: 768px) {
            footer {
                grid-template-columns: 1fr;
                gap: 30px;
                padding: 40px 15px 20px;
            }

            .column.address p {
                font-size: 18px;
            }

            .social-icons {
                justify-content: center;
            }

            .column.address {
                padding: 25px 15px;
            }

            .column.contact-about img {
                display: block;
                margin: 0 auto 20px auto;
            }



            .floating-reserve-btn {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 9999;
                display: none;
            }

            .pulse-btn {
                animation: pulse 1.5s infinite;
            }

            @@keyframes pulse {
                0% {
                    transform: scale(1);
                }

                50% {
                    transform: scale(1.1);
                }

                100% {
                    transform: scale(1);
                }
            }
        }
    </style>


    @Styles.Render("~/Content/css")
</head>
<body>
    @{
        // Detecta si es la página principal (Home/Index)
        bool esHomeIndex = (ViewContext.RouteData.Values["controller"].ToString().ToLower() == "home"
            && ViewContext.RouteData.Values["action"].ToString().ToLower() == "index");
    }


    <nav class="navbar navbar-expand-sm navbar-dark sticky-top @(esHomeIndex ? "transparent" : "")" id="mainNavbar">

        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <img src="~/Resources/Images/logo.png" alt="ExpediCheck Logo" height="48" />
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbarContent"
                    aria-controls="mainNavbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-between" id="mainNavbarContent">
                <ul class="navbar-nav me-auto mb-2 mb-sm-0">
                    <li class="nav-item"><a class="nav-link" href="/Reservas">Reservas</a></li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#nosotros" id="nosotrosDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Nosotros
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="nosotrosDropdown">
                            <li><a class="dropdown-item" href="#acerca">Acerca</a></li>
                            <li><a class="dropdown-item" href="#contacto">Contacto</a></li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="#resenas">Reseñas</a></li>
                    @if (Request.IsAuthenticated)
                    {
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("MisReservas", "Reservas")">Mis reservas</a>
                        </li>
                    }
                    @if (Request.IsAuthenticated && User.IsInRole("Administrador"))
                    {
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#administracion" id="administracionDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Administración
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="administracionDropdown">
                                <li><a class="dropdown-item" href="/Administracion/Usuarios">Usuarios</a></li>
                                <li><a class="dropdown-item" href="/Administracion/Consultas">Consultas</a></li>
                                <li><a class="dropdown-item" href="/Administracion/Reviews">Reseñas</a></li>
                                <li><a class="dropdown-item" href="/Servicios">Servicios</a></li>
                            </ul>
                        </li>
                    }

                </ul>

                <ul class="navbar-nav">
                    @if (Request.IsAuthenticated)
                    {
                        <li class="nav-item">
                            @{
                                var userManager = HttpContext.Current.GetOwinContext().GetUserManager<Proyecto_ExpedicionOxigeno.ApplicationUserManager>();
                                var currentUser = userManager.FindById(User.Identity.GetUserId());
                                var nombre = currentUser?.Nombre ?? "Usuario";
                            }
                        </li>
                        <li class="nav-item">
                            <span class="nav-link text-white">Hola, @nombre</span>
                        </li>


                        <li class="nav-item">
                            @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm" }))
                            {
                                @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-outline-light">Cerrar sesión</button>
                            }
                        </li>
                    }
                    else
                    {
                        @*<li class="nav-item">
                                <a class="nav-link nav-login" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Log in</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-register" href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Registrarse</a>
                            </li>*@
                        <li class="nav-item">
                            <a class="btn btn-outline-light mx-1" href="@Url.Action("Login", "Account")">Iniciar sesión</a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-outline-light mx-1" href="@Url.Action("Register", "Account")">Registrarse</a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </nav>
    @if (esHomeIndex)
    {
        <script>
            function updateNavbarTransparency() {
                const nav = document.getElementById("mainNavbar");
                // Si el scroll está en la parte superior, el Hero Banner está visible
                if (window.scrollY < window.innerHeight - nav.offsetHeight) {
                    nav.classList.add("transparent");
                } else {
                    nav.classList.remove("transparent");
                }
            }
            window.addEventListener("scroll", updateNavbarTransparency);
            window.addEventListener("resize", updateNavbarTransparency);
            document.addEventListener("DOMContentLoaded", updateNavbarTransparency);

        </script>
    }
    @RenderSection("HeroBanner", required: false)
    <div class="container body-content">
        @RenderBody()
        <hr />
        <footer>
            <div class="column contact-about">
                <ul>
                    <li><p>Correo: <a href="mailto:expedicion@gmail.com?subject=Consulta%20-%20Expedici%C3%B3n%20Ox%C3%ADgeno">expedicion@gmail.com</a></p></li>
                    <li><p>Teléfono: <a href="tel:+50625202100">2520-2100</a></p></li>
                </ul>
                <h5 style="color: #000;">También podés encontrarnos en redes sociales:</h5>
                <div class="d-flex flex-column align-items-center gap-3 mt-3">
                    <!-- Íconos sociales -->
                    <div class="social-icons">
                        <a href="https://www.facebook.com/OxigenoCostaRica" target="_blank" title="Ir a Facebook">
                            <img src="~/Content/Images/icon_Facebook.png" alt="Facebook" />
                        </a>
                        <a href="https://www.instagram.com/oxigenocr/" target="_blank" title="Ir a Instagram">
                            <img src="~/Content/Images/icon_Instagram.png" alt="Instagram" />
                        </a>
                    </div>

                    <!-- Texto institucional -->
                    <div class="text-center px-3">
                        <h3>¿Quiénes somos?</h3>
                        <p>
                            Expedición Oxígeno es una atracción de aventura ubicada en el O2 de Oxígeno, la cual alberga 3 actividades cuyo propósito es proveer diversión y adrenalina a un público de todas las edades. Lo único que necesitás es cumplir con la estatura mínima para cada una de las actividades.
                        </p>
                    </div>
                </div>

            </div>
            <div class="column address">
                <h3>Dirección</h3>
                <p>Heredia, San Francisco</p>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4297.640276655829!2d-84.13384462458062!3d9.99444979011064!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8fa0fae4d6f2f3c9%3A0xca979eb2e17fba1d!2sCentro%20Comercial%20Ox%C3%ADgeno!5e1!3m2!1ses-419!2scr!4v1751737305409!5m2!1ses-419!2scr" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </footer>
    </div>

    <!-- Modal de Log in -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title" id="loginModalLabel">Iniciar sesión</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Account/Login">
                        @Html.AntiForgeryToken()
                        <div class="mb-3">
                            <label for="emailLogin" class="form-label">Correo electrónico</label>
                            <input type="email" class="form-control" id="emailLogin" name="Email" required>
                        </div>
                        <div class="mb-3">
                            <label for="passwordLogin" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="passwordLogin" name="Password" required>
                        </div>
                        <button type="submit" class="btn btn-success w-100">Entrar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Registro -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title" id="registerModalLabel">Crear cuenta</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/Account/Register">
                        @Html.AntiForgeryToken()
                        <div class="mb-3">
                            <label for="emailRegister" class="form-label">Correo electrónico</label>
                            <input type="email" class="form-control" id="emailRegister" name="Email" required>
                        </div>
                        <div class="mb-3">
                            <label for="passwordRegister" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="passwordRegister" name="Password" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirmar contraseña</label>
                            <input type="password" class="form-control" id="confirmPassword" name="ConfirmPassword" required>
                        </div>
                        <button type="submit" class="btn btn-success w-100">Registrarme</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal de Confirmación de Registro -->
    <div class="modal fade" id="registroExitosoModal" tabindex="-1" aria-labelledby="registroExitosoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="registroExitosoModalLabel">Registro Exitoso</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body text-center">
                    ¡Gracias por registrarte!<br />
                    Te llegará un correo a la dirección brindada para confirmar tu cuenta.
                </div>
            </div>
        </div>
    </div>
    <!-- Modal: Debes iniciar sesión -->
    <div class="modal fade" id="loginRequiredModal" tabindex="-1" aria-labelledby="loginRequiredModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="loginRequiredModalLabel">Inicio de sesión requerido</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body text-center">
                    Debes iniciar sesión para dejar una reseña o consulta.
                    <div class="mt-3">
                        <a href="@Url.Action("Login", "Account", new { ReturnUrl = Request.RawUrl })" class="btn btn-success">
                            Iniciar sesión
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
</body>
</html>
